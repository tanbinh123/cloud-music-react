{"version":3,"sources":["webpack:///./src/application/Album/index.jsx","webpack:///./src/application/Album/style.js","webpack:///./src/components/album-detail/index.jsx","webpack:///./src/components/album-detail/style.js"],"names":["Album","props","useState","showStatus","setShowStatus","title","setTitle","marquee","setMarquee","id","match","params","headEl","useRef","musicNoteRef","getAlbumListDispatch","songsCount","pullUpLoading","currentAlbum","enterLoading","currentAlbumJS","toJS","handleBack","useCallback","handlePullUp","musicAnimation","x","y","current","startAnimation","useEffect","handleScroll","pos","headDOM","minHeight","getBoundingClientRect","height","percent","Math","abs","style","backgroundColor","opacity","min","name","history","goBack","isEmptyObject","mapStateToProps","state","getIn","size","mapDispatchToProps","dispatch","changeEnterLoading","getAlbumList","connect","React","memo","Container","Styled","div","play","AlbumDetail","tracks","renderTopDesc","coverImgUrl","parseInt","playCount","creator","avatarUrl","nickname","renderMenu","renderSongList","subscribedCount","TopDesc","background","Menu"],"mappings":"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","file":"6-4974db2789f7f7e1df7b.js","sourcesContent":["import React, { useEffect, useState, useCallback, useRef } from 'react'\nimport { connect } from \"react-redux\"\nimport { CSSTransition } from \"react-transition-group\"\nimport Header from \"baseUI/header\"\nimport { Container } from \"./style\"\nimport Scroll from \"baseUI/scroll\"\nimport AlbumDetail from \"@/album-detail\"\nimport { getAlbumList, changeEnterLoading } from \"./store/actionCreator\"\nimport { isEmptyObject } from \"utils\"\nimport EnterLoading from \"utils/EnterLoading\";\nimport Loading from \"baseUI/loading\"\nimport style from \"assets/global-style\"\nimport MusicNote from \"baseUI/music-note\"\nfunction Album(props) {\n  // 默认开始的时候为true但是点击返回的上一层的时候为false\n  const [showStatus, setShowStatus] = useState(true);\n  const [title, setTitle] = useState(\"\")\n  // 这只滚动的时候header是否文字滚动\n  const [marquee, setMarquee] = useState(false);\n  // 拿到传过来的id值\n  const id = props.match.params.id;\n  const headEl = useRef();\n  const musicNoteRef = useRef();\n  const { getAlbumListDispatch } = props;\n  const { songsCount, pullUpLoading, currentAlbum, enterLoading } = props;\n  const currentAlbumJS = currentAlbum.toJS();\n  // 将immutable的数据转换出来\n  const handleBack = useCallback(() => {\n    setShowStatus(false);\n  }, []);\n\n  const handlePullUp = () => {\n\n  }\n\n  /* \n    点击歌曲出现的动画\n  */\n  const musicAnimation = (x, y) => {\n    musicNoteRef.current.startAnimation({ x, y });\n  };\n  useEffect(() => {\n    getAlbumListDispatch(id);\n  }, [getAlbumListDispatch, id]);\n\n  const handleScroll = useCallback((pos) => {\n    let headDOM = headEl.current;\n    let minHeight = -headDOM.getBoundingClientRect().height;\n    let percent = Math.abs(pos.y / minHeight);\n    if (pos.y < minHeight) {\n      headDOM.style.backgroundColor = style[\"theme-color\"];\n      // 加入动画效果\n      headDOM.style.opacity = Math.min(1, (percent - 1) / 2);\n      // 这只title文字\n      setTitle(currentAlbumJS && currentAlbumJS.name);\n      setMarquee(true);\n    } else {\n      headDOM.style.backgroundColor = '';\n      headDOM.style.opacity = 1;\n      // 设置title的值\n      setTitle(\"歌单\");\n      setMarquee(false);\n    }\n  })\n  return (\n    <CSSTransition\n      in={showStatus}\n      timeout={300}\n      appear={true}\n      classNames=\"fly\"\n      mountOnEnter\n      unmountOnExit\n      onExited={props.history.goBack}\n    >\n      {/* 整个内容区域 */}\n      <Container play={songsCount}>\n        {\n          enterLoading ? <EnterLoading><Loading></Loading></EnterLoading> :\n            <>\n              <Header ref={headEl} title={title} isMarquee={marquee} handleClick={handleBack}></Header>\n              {\n                !isEmptyObject(currentAlbumJS) && (<Scroll\n                  onScroll={handleScroll}\n                  pullUp={handlePullUp}\n                  pullUpLoading={pullUpLoading}\n                  bounceTop={false}\n                >\n                  <AlbumDetail currentAlbum={currentAlbumJS} musicAnimation={musicAnimation}></AlbumDetail>\n                </Scroll>)\n              }\n            </>\n        }\n        <MusicNote ref={musicNoteRef}></MusicNote>\n      </Container>\n    </CSSTransition>\n  )\n}\nconst mapStateToProps = state => ({\n  currentAlbum: state.getIn([\"album\", \"currentAlbum\"]),\n  enterLoading: state.getIn([\"album\", \"enterLoading\"]),\n  songsCount : state.getIn([\"player\", \"playList\"]).size\n})\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    // 通过id拿到该id对应的歌单数据\n    getAlbumListDispatch(id) {\n      dispatch(changeEnterLoading(true))\n      dispatch(getAlbumList(id));\n    }\n  }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(Album))","import Styled from \"styled-components\"\nimport style from \"assets/global-style.js\"\n\nexport const Container = Styled.div`\n  position : fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom : ${props => props.play > 0 ? \".6rem\" : 0};\n  z-index: 100;\n  width: 100%;\n  overflow: hidden;\n  background : #f2f3f4;\n  transform-origin : right bottom;\n  &.fly-enter, &.fly-appear{\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\n  }\n  &.fly-enter-active, &.fly-appear-active{\n    transition: transform .3s;\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\n  }\n  &.fly-exit{\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\n  }\n  &.fly-exit-active{\n    transition: transform .3s;\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\n  }\n`","import React from 'react'\nimport { TopDesc, Menu } from './style'\nimport SongList from \"application/SongList\"\nfunction AlbumDetail(props) {\n  const { currentAlbum, musicAnimation } = props;\n  const tracks = currentAlbum.tracks || [];\n  const renderTopDesc = () => {\n    return (\n      <TopDesc background={currentAlbum.coverImgUrl} >\n        <div className=\"background\"></div>\n        <div className=\"img_wrapper\">\n          <div className=\"decorate\"></div>\n          <img src={currentAlbum.coverImgUrl} alt=\"\" />\n          <div className=\"play_count\">\n            <i className=\"iconfont play\">&#xe885;</i>\n            <span className=\"count\">{parseInt(currentAlbum.playCount / 10000)}万</span>\n          </div>\n        </div>\n        <div className=\"desc_wrapper\">\n          <div className=\"title\">{currentAlbum.name}</div>\n          <div className=\"person\">\n            <div className=\"avatar\">\n              <img src={currentAlbum.creator.avatarUrl} alt=\"\" />\n            </div>\n            <div className=\"name\">{currentAlbum.creator.nickname}</div>\n          </div>\n        </div>\n      </TopDesc>\n\n    )\n  }\n\n  /* menu菜单的布局 */\n  const renderMenu = () => {\n    return (\n      <Menu>\n        <div>\n          <i className=\"iconfont\">&#xe6ad;</i>\n          评论\n        </div>\n        <div>\n          <i className=\"iconfont\">&#xe86f;</i>\n          点赞\n        </div>\n        <div>\n          <i className=\"iconfont\">&#xe62d;</i>\n          收藏\n        </div>\n        <div>\n          <i className=\"iconfont\">&#xe606;</i>\n          更多\n        </div>\n      </Menu>\n    )\n  }\n  const renderSongList = () => {\n    return (\n      <SongList\n        songs={tracks} \n        collectCount={currentAlbum.subscribedCount}\n        showCollect={true}\n        musicAnimation={musicAnimation}\n      ></SongList>\n    )\n  }\n  return (\n    <div>\n      {renderTopDesc()}\n      {renderMenu()}\n      {renderSongList()}\n    </div>\n  )\n}\nexport default React.memo(AlbumDetail)\n","import Styled from \"styled-components\"\nimport style from \"assets/global-style\"\n\nexport const TopDesc = Styled.div`\n  background-size: 100%;\n  padding: .05rem .2rem;\n  padding-bottom: .5rem;\n  margin-bottom: .2rem;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  box-sizing: border-box;\n  width: 100%;\n  height: 2.75rem;\n  position: relative;\n  .background {\n    z-index: -1;\n    background: contain;\n    background: url(${props => props.background}) left top no-repeat;\n    background-position: 0 0;\n    background-size: 100% 100%;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    filter: blur(.2rem);\n  }\n  .img_wrapper{\n    width: 1.2rem;\n    height : 1.2rem;\n    position : relative;\n    .decorate{\n      position: absolute;\n      top: 0;\n      width: 100%;\n      height: .35rem;\n      border-radius: .03rem;\n      background: linear-gradient(hsla(0,0%,43%,.4),hsla(0,0%,100%,0));\n    }\n    img {\n      width: 1.20rem;\n      height: 1.20rem;\n      border-radius: .03rem;\n    }\n    .play_count {\n      position : absolute;\n      right: .02rem;\n      top: .02rem;\n      font-size: .12rem;\n      line-height: .15rem;\n      color: ${style[\"font-color-light\"]};\n      .play {\n        vertical-align : top;\n      }\n    }\n  }\n  .desc_wrapper{\n    display : flex;\n    flex-direction: column;\n    justify-content : space-around;\n    flex : 1;\n    height: 1.20rem;\n    padding: 0 .1rem;\n    .title {\n      max-height : .7rem;\n      overflow : hidden;\n      text-overflow : ellipsis;\n      color : ${style[\"font-color-light\"]};\n      font-weight : 700;\n      line-height : 1.5;\n      font-size : .16rem;\n    }\n    .person {\n      display : flex;\n      .avatar {\n        width: .2rem;\n        height: .2rem;\n        margin-right : .05rem;\n        img {\n          width: 100%;\n          height: 100%;\n          border-radius : 50%;\n        }\n      }\n      .name {\n        line-height: .2rem;\n        font-size: .14rem;\n        color: #bba8a8;\n      }\n    }\n  }\n`\nexport const Menu = Styled.div`\n  position : relative;\n  display : flex;\n  justify-content : space-between;\n  box-sizing: border-box;\n  padding: 0 .30rem .20rem .30rem;\n  margin: -1rem 0 0 0;\n  >div {\n    display : flex;\n    flex-direction: column;\n    line-height: .20rem;\n    text-align: center;\n    font-size: .12rem;\n    color: #3b1f1f;\n    color: ${style[\"font-color-light\"]};\n    z-index: 1000;\n    font-weight: 500;\n  }\n`"],"sourceRoot":""}